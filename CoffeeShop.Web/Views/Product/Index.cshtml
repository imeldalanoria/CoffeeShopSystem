@model IEnumerable<CoffeeShop.Model.ProductModel>

@{
    ViewBag.Title = "Product";
}

<h2>Product</h2>
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <p>
        @Html.DropDownList("SelectedOffice", "Select Office")
        <input type="submit" value="Filter" id="btnFilter"/>
    </p>
    <p >
        <canvas id="myChart"></canvas>
    </p>
    

    <p>
        @Html.ActionLink("Create New", "Create")
    </p>
    <table class="table" id="tblProduct">
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.ProductName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Unit)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.OfficeInfo_OfficeID)
            </th>
            <th></th>
        </tr>

        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.ProductName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Unit)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.OfficeInfo_OfficeID)
                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", new { id = item.ProductID }) |
                    @Html.ActionLink("Details", "Details", new { id = item.ProductID }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.ProductID })
                </td>
            </tr>
        }

    </table>
}
@section Scripts
{
    <script>
        $(document).ready(function () {

            //$('#btnFilter').click(function () {
                        //});

            var id = $("#SelectedOffice").val();
            $.ajax({
                    type: "POST",
                url: "@Url.Action("GetProduct", "Product")" + "/" + id,
                    dataType: "json",
                    headers: { 'VerificationToken': $("#forgeryToken").val() }
                }).done(
                    function (data) {
                        var aData = data.data;
                        createProductChart(aData);
                    });

            function createProductChart(data) {
                var CoffeeBeans = data[0].Unit;
                var Sugar = data[1].Unit;
                var Milk = data[2].Unit;

                var ctx = document.getElementById('myChart').getContext('2d');
                var chart = new Chart(ctx, {
                    type: 'horizontalBar',
                    data: {
                        labels: ["Coffee Beans", "Sugar", "Milk"],
                        datasets: [{
                            label: "Items",
                            backgroundColor: ["rgba(128, 128, 128, 1)", "rgba(222, 163, 104, 1)", "rgba(237, 236, 227, 1)"],
                            data: [CoffeeBeans, Sugar, Milk],
                        }]
                    },
                    options: {
                        scales: {
                            xAxes: [{
                                ticks: {
                                    beginAtZero: true
                                }
                            }],
                            //yAxes: [{
                            //    barPercentage: 0.5
                            //}]
                        }
                    }
                });
            }
        });
    </script>
}